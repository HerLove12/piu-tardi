USE tardi;

CREATE TABLE utente(
	ID int(11) auto_increment ,
    password varchar(256) NOT NULL,
    nome varchar(30) NOT NULL,
    cognome varchar(30) NOT NULL,
    eta int(11),
    classe varchar(30),
    email varchar(30) NOT NULL,
	foto varchar(50),
    PRIMARY KEY(ID)
);

CREATE TABLE tipologia(
	ID int(11) auto_increment,
    	nome varchar(30),
	PRIMARY KEY(ID)
);

CREATE TABLE annuncio(
	ID int(11) auto_increment,
    nome varchar(30) NOT NULL,
    descrizioni varchar(50),
    foto varchar(50),
    datacaricamento date NOT NULL,
    ID_utente int(11) NOT NULL,
    ID_tipologia int(11) NOT NULL,
    PRIMARY KEY(ID),
    FOREIGN KEY(ID_utente) REFERENCES utente(ID) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY(ID_tipologia) REFERENCES tipologia(ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE proposta(
	ID int(11) NOT NULL auto_increment,
    prezzo int(11) NOT NULL,
    ID_utente int(11) NOT NULL,
    dataproposta date,
    ID_annuncio int(11) NOT NULL,
    stato varchar(11),
    PRIMARY KEY(ID),
    FOREIGN KEY (ID_utente) REFERENCES utente(ID) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_annuncio) REFERENCES annuncio(ID) ON UPDATE CASCADE ON DELETE CASCADE
);

/*---------------- ESEMPI --------------------*/
INSERT INTO utente (password, nome, cognome, eta, classe, email, foto) VALUES ('password123', 'Alice', 'Rossi', 25, 'A', 'alice@email.com', 'alice.jpg');
INSERT INTO utente (password, nome, cognome, eta, classe, email, foto) VALUES ('qwerty456', 'Bob', 'Verdi', 30, 'B', 'bob@email.com', 'bob.jpg');
INSERT INTO utente (password, nome, cognome, eta, classe, email, foto) VALUES ('secure789', 'Charlie', 'Bianchi', 28, 'C', 'charlie@email.com', 'charlie.jpg');

INSERT INTO tipologia (nome) VALUES ('Elettronica');
INSERT INTO tipologia (nome) VALUES ('Abbigliamento');
INSERT INTO tipologia (nome) VALUES ('Libri');

INSERT INTO annuncio (nome, descrizioni, foto, datacaricamento, ID_utente, ID_tipologia) VALUES ('iPhone X', 'Nuovo di zecca!', 'iphone.jpg', '2024-05-15', 1, 1);
INSERT INTO annuncio (nome, descrizioni, foto, datacaricamento, ID_utente, ID_tipologia) VALUES ('Giacca in pelle', 'Stile vintage', 'giacca.jpg', '2024-05-14', 2, 2);
INSERT INTO annuncio (nome, descrizioni, foto, datacaricamento, ID_utente, ID_tipologia) VALUES ('Harry Potter e la pietra filosofale', 'Edizione speciale', 'libro.jpg', '2024-05-13', 3, 3);

INSERT INTO proposta (prezzo, ID_utente, dataproposta, ID_annuncio, stato) VALUES (500, 2, '2024-05-15', 1, 'in attesa');
INSERT INTO proposta (prezzo, ID_utente, dataproposta, ID_annuncio, stato) VALUES (80, 3, '2024-05-14', 2, 'accettata');
INSERT INTO proposta (prezzo, ID_utente, dataproposta, ID_annuncio, stato) VALUES (20, 1, '2024-05-13', 3, 'rifiutata');